<?xml version="1.0" encoding="UTF-8"?>

<properties>
    <!--    查询所有正在处理或者未签收的流程节点  qingl2      -->
	<property name="getProcessNodeUnComplete">
		<![CDATA[
			select t1.*,t2.user_realname as realName,t2.org_id as orgId ,t2.user_mobiletel1 as mobile from 
			(
			            select 1 as state,
			                   a.id_ as id,
						       a.name_ as taskName,
						       a.create_time_ as createTime,
						       i.user_id_ as userId,
						       b.name_ as processName,
						       c.duration_node as duration,
						       c.simpledate as simpleDate,
						       d.messagetempleid as messageTempleId,
						       d.emailtempleid as emailTempleId
						  from ACT_RU_TASK a
						 inner join ACT_RU_IDENTITYLINK I on I.TASK_ID_ = a.ID_
						  left join act_re_procdef b on b.id_ = a.proc_def_id_
						  left join (select bb.messagetempleid,
						                    bb.emailtempleid,
						                    bb.duration_node,
						                    bb.simpledate,
						                    aa.process_key,
						                    aa.node_type,
						                    aa.node_key
						               from td_wf_activiti_node_info aa
						               left join td_wf_activiti_node_candidate bb on aa.id =
						                                                             bb.node_id
						                                                         and bb.business_type = '0'
						              where aa.node_type = 'userTask') c on c.process_key = b.key_
						                                                and a.task_def_key_ =
						                                                    c.node_key
						  left join td_wf_proc_messtemplate d on d.process_key = b.key_
						
						 WHERE a.ASSIGNEE_ is null
						   and I.TYPE_ = 'candidate'
						   and a.suspension_state_ = 1 
						union all
						
						select 2 as state,
						       a.id_ as id,
						       a.name_ as taskName,
						       a.create_time_ as createTime,
						       a.assignee_ as userId,
						       b.name_ as processName,
						       c.duration_node as duration,
						       c.simpledate as simpleDate,
						       d.messagetempleid as messageTempleId,
						       d.emailtempleid as emailTempleId
						  from ACT_RU_TASK a
						  left join act_re_procdef b on b.id_ = a.proc_def_id_
						  left join (select bb.messagetempleid,
						                    bb.emailtempleid,
						                    bb.duration_node,
						                    bb.simpledate,
						                    aa.process_key,
						                    aa.node_type,
						                    aa.node_key
						               from td_wf_activiti_node_info aa
						               left join td_wf_activiti_node_candidate bb on aa.id =
						                                                             bb.node_id
						                                                         and bb.business_type = '0'
						              where aa.node_type = 'userTask') c on c.process_key = b.key_
						                                                and a.task_def_key_ =
						                                                    c.node_key
						  left join td_wf_proc_messtemplate d on d.process_key = b.key_
						 where a.ASSIGNEE_ is not null
						   and a.suspension_state_ = 1 
						 order by 3 desc
			
			) t1 left join (
			
			select t1.user_name , t1.user_realname,t1.user_id,t1.user_mobiletel1,t2.org_id from
			
			TD_SM_USER t1 left join  TD_SM_USERJOBORG t2 on t1.user_id = t2.user_id
			
			) t2 on t1.userId = t2.user_name
		]]>
	</property>
	
	
	
</properties>